{"ts":1359983648400,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"/*\n\tRequire the Swig module for templating.\n*/\nvar swig    = require('swig'),\n\t_       = require('underscore')\n\tdbquery = require('../db/queries'),\n\titunes  = require('../config/itunes'),\n\tcharts  = require('../config/charts'),\n\tLastfm  = require('lastfmapi'),\n\thelpers = require('../frontend/scripts/helpers'),\n\thelpers = helpers.helpers,\n\tlastfm  = new Lastfm({\n\t\tapi_key: \t\"29c1ce9127061d03c0770b857b3cb741\",\n\t\tsecret: \"473680e0257daa9a7cb45207ed22f5ef\"\n\t})\n_.str = require('underscore.string')\n_.mixin(_.str.exports());\n_.str.include('Underscore.string', 'string');\n/*\n\tThis is the current directory without the \"/routes\" at the end, so basically the parent directory\n*/\nvar dirup = __dirname.substr(0, __dirname.length - 7);\nvar\tparseduration = function(number) {\n\tvar fullseconds = Math.round(number / 1000), \n\t\tminutes = Math.floor(fullseconds/60),\n\t\tseconds = fullseconds-(minutes*60)\n\tif (seconds < 10) {\n\t\tseconds = \"0\" + seconds;\n\t}\n\treturn minutes+\":\"+seconds;\n}\n/*\n\tThis function returns the artistpage to the user\n*/\nthis.lastloop = null;\nvar artisttemplate    = dirup + '/sites/artist.html',\n\talbumtemplate     = dirup + '/sites/album.html',\n\ttracklisttemplate = dirup + '/sites/tracklist.html',\n\talbumwrapper \t  = dirup + '/sites/album-page.html'\nthis.drawartist = function(request, response) {\n\t/*\n\t\tDefine custom parameters\n\t*/\n\tvar artistid = _.str.titleize(request.params.id);\n\n\t/*\n\t\tQuery database for artist informations\n\t*/\n\tdbquery.getArtist(artistid, function(artistarray) {\n\t\t/*\n\t\t\tGet the HTML template and call \"compile\"\n\t\t*/\n\t\tvar tmpl = swig.compileFile(artisttemplate);\n\t\t/*\n\t\t\tIf nothing found, return null\n\t\t*/\n\t\tvar artistinfo = artistarray.length == 0 ? null : artistarray[0];\n\t\t/*\n\t\t\tIf null, add to the database\n\t\t*/\n\t\tif (artistinfo == null && views.lastloop != artistid) {\n\t\t\tvar loop = 0;\n\t\t\titunes.lookup(artistid, {entity: \"musicArtist\"}, function(res) {\n\t\t\t\tif (res.results.length != 0) {\n\t\t\t\t\tvar firstResult = res.results[0]\n\t\t\t\t\tvar a = {\n\t\t\t\t\t\tname: firstResult.artistName,\n\t\t\t\t\t\tid: firstResult.artistId,\n\t\t\t\t\t\tgenre: firstResult.primaryGenreName\n\t\t\t\t\t}\n\t\t\t\t\tdbquery.addArtist(a, function() {\n\t\t\t\t\t\tviews.lastloop = artistid;\n\t\t\t\t\t\t/*\n\t\t\t\t\t\t\tLoop: Be careful!\n\t\t\t\t\t\t*/\n\t\t\t\t\t\tviews.drawartist(request, response);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tviews.error({params: {code: 499}}, response);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse if (artistinfo != null) {\n\t\t\tvar artist = artistinfo.name\n\n\t\t\tif (artistinfo.lastfm == undefined) {\n\t\t\t\tlastfm.artist.getInfo(\n\t\t\t\t\t{\n\t\t\t\t\t\tartist: artist\n\t\t\t\t\t}, \n\t\t\t\t\tfunction(err, data) {\n\t\t\t\t\t\tif (!err) {\n\t\t\t\t\t\t\tvar lfmdata = {\n\t\t\t\t\t\t\t\timage: \t\t_.last(data.image)[\"#text\"],\n\t\t\t\t\t\t\t\tmbid: \t\tdata.mbid\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tartistinfo.lastfm = lfmdata;\n\t\t\t\t\t\t\tdbquery.updateArtist(artistinfo);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t}\n\t\t\t/*\n\t\t\t\tDb query for albums\n\t\t\t*/\n\t\t\tdbquery.getAlbums(artistid, function(albumarray) {\n\t\t\t\t/*\n\t\t\t\t\tIf no albums were found, return null\n\t\t\t\t*/\n\t\t\t\tvar albumsinfo = albumarray.length == 0 ? null : albumarray\n\t\t\t\t/*\n\t\t\t\t\tHandle duplicates: Filter them out and show them as extra options.\n\t\t\t\t*/\n\t\t\t\tvar before = albumsinfo\n\t\t\t\tif (albumsinfo) {\n\t\t\t\t\talbumsinfo = _.uniq(albumsinfo, false, function(album) {\n\t\t\t\t\t\tvar prename = (album.name != 1) ? album.name : '' // Some albums are not strings, they are numbers! wtf...\n\t\t\t\t\t\tname = prename.substr(0, (prename.indexOf(\"(\") == -1) ? prename.length : prename.indexOf(\"(\"))\n\t\t\t\t\t\treturn _.str.slugify(name);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tvar after = albumsinfo;\n\t\t\t\t/*\n\t\t\t\t\tGet songs for each album from MongoDB\n\t\t\t\t*/\n\t\t\t\tvar albums = [];\n\t\t\t\tif (albumsinfo) {\n\t\t\t\t\tfunction getAlbumTracks() {\n\t\t\t\t\t\tvar cds = [];\n\t\t\t\t\t\tvar album = albumsinfo[j];\n\t\t\t\t\t\tdbquery.getTracksFromAlbum(album.id, function(items) {\n\t\t\t\t\t\t\t/*\n\t\t\t\t\t\t\t\tGet number of CD's\n\t\t\t\t\t\t\t\tMake array with n empty arrays. n = cdcount\n\t\t\t\t\t\t\t\tAdd tracks to correct CD\n\t\t\t\t\t\t\t\tSort album tracks\n\t\t\t\t\t\t\t*/\n\t\t\t\t\t\t\tif (items[0] == undefined) {\n\t\t\t\t\t\t\t\tconsole.log(\"Error: No items in album! Left album out. Album id:\", album.id)\n\t\t\t\t\t\t\t\t//response.end(\"Server error.\");\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar cdcount = items[0].cdcount;\n\t\t\t\t\t\t\tfor (i=0;i<cdcount;i++) {\n\t\t\t\t\t\t\t\tcds.push([]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t_.each(items, function(track) {\n\t\t\t\t\t\t\t\tcds[track.cdinalbum-1].push(track);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tvar discs = []\n\t\t\t\t\t\t\t/*\tSort the tracks by their number*/\n\t\t\t\t\t\t\t_.each(cds, function(cd, key) {\n\t\t\t\t\t\t\t\tvar disc = _.sortBy(cd, function(track) {return track.numberinalbum});\n\t\t\t\t\t\t\t\tdiscs.push(disc)\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\talbum.cds = discs;\n\t\t\t\t\t\t\talbums.push(album)\n\t\t\t\t\t\t});\n\t\t\t\t\t\tj++;\n\t\t\t\t\t\tif (j == albumcount) {\n\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tgetAlbumTracks()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tvar j \t\t   = 0,\n\t\t\t\t\t\talbumcount = albumsinfo.length \n\t\t\t\t\tgetAlbumTracks()\n\t\t\t\t}\n\t\t\t\t/*\n\t\t\t\t\tParse () in album titles\n\t\t\t\t*/\n\t\t\t\tvar newAlbumsArray = [];\n\t\t\t\t_.each(albumsinfo, function(album) {\n\t\t\t\t\tvar prename \t\t   = album.name != 1 ? album.name : '',\n\t\t\t\t\t\tname   \t\t   \t   = prename.substr(0, (prename.indexOf(\"(\") == -1) ? prename.length : prename.indexOf(\"(\")),\n\t\t\t\t\t\tparenthesisregex   = /\\(([^()]+)\\)/g,\n\t\t\t\t\t\tinparenthesis \t   = prename.match(parenthesisregex),\n\t\t\t\t\t\twithoutbrackets    = inparenthesis ? inparenthesis[0].substr(1, inparenthesis[0].length-2) : null\n\t\t\t\t\talbum.name \t\t\t   = name;\n\t\t\t\t\talbum.subtitle \t\t   = withoutbrackets;\n\t\t\t\t\tnewAlbumsArray.push(album);\n\t\t\t\t})\n\t\t\t\talbumsinfo = newAlbumsArray;\n\t\t\t\t/*\n\t\t\t\t\tQuery for top tracks\n\t\t\t\t*/\n\t\t\t\tdbquery.getTracks(artist, function(tracksarray) {\n\t\t\t\t\tvar tracks = tracksarray\n\t\t\t\t\tif (tracks) {\n\t\t\t\t\t\ttracks = _.uniq(tracks, false, function(song) {\n\t\t\t\t\t\t\treturn _.str.slugify(song.name.toLowerCase());\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\t/*\n\t\t\t\t\t\tpass in parameters, custom for every artist\n\t\t\t\t\t*/\n\t\t\t\t\tvar output = tmpl.render({\n\t\t\t\t\t\tartist: \t\t\tartistinfo,\n\t\t\t\t\t\talbums: \t\t\talbums,\n\t\t\t\t\t\ttracks: \t\t\ttracks,\n\t\t\t\t\t\talbumtemplate: \t\talbumtemplate,\n\t\t\t\t\t\ttracklist: \t\t\ttracklisttemplate,\n\t\t\t\t\t\tparseduration: \t\tparseduration,\n\t\t\t\t\t\tfromserver: \t\ttrue,\n\t\t\t\t\t\tcoverstack:         _.first(albums, 10)\n\t\t\t\t\t})\n\t\t\t\t\t/*\n\t\t\t\t\t\tSend to user\n\t\t\t\t\t*/\n\t\t\t\t\tresponse.end(output);\n\t\t\t\t});\n\t\t\t})\n\t\t}\n\t\telse {\n\t\t\tconsole.log(\"Error! No artist info.\");\n\t\t\tresponse.end(\"Server error.\");\n\t\t}\n\t\t\n\t})\n}\nthis.drawalbum = function(request, response) {\n\t/*\n\t\tLoad template\n\t*/\n\tvar tmpl = swig.compileFile(dirup + \"/sites/album-page.html\");\n\t/*\n\t\tDefine custom parameters\n\t*/\n\tvar albumid = request.params.album;\n\tvar cds = [];\n\tdbquery.getSingleAlbum(albumid, function(albumarray) {\n\t\t/*\n\t\t\tIf not found, album is null\n\t\t*/\n\t\tvar albuminfo = albumarray.length == 0 ? null : albumarray[0]\n\t\t/*\n\t\t\tPass parameters to template\n\t\t*/\n\t\tif (albuminfo) {\n\t\t\tdbquery.getTracksFromAlbum(albuminfo.id, function(items) {\n\t\t\t\tconsole.log(items);\n\t\t\t\t/*\n\t\t\t\t\tGet number of CD's\n\t\t\t\t\tMake array with n empty arrays. n = cdcount\n\t\t\t\t\tAdd tracks to correct CD\n\t\t\t\t\tSort album tracks\n\t\t\t\t*/\n\t\t\t\tif (items[0] == undefined) {\n\t\t\t\t\tresponse.end(\"Server error.\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar cdcount = items[0].cdcount;\n\t\t\t\tfor (i=0;i<cdcount;i++) {\n\t\t\t\t\tcds.push([]);\n\t\t\t\t}\n\t\t\t\t_.each(items, function(track) {\n\t\t\t\t\tcds[track.cdinalbum-1].push(track);\n\t\t\t\t});\n\t\t\t\tvar discs = []\n\t\t\t\t/*\tSort the tracks by their number*/\n\t\t\t\t_.each(cds, function(cd, key) {\n\t\t\t\t\tvar disc = _.sortBy(cd, function(track) {return track.numberinalbum});\n\t\t\t\t\tdiscs.push(disc)\n\t\t\t\t})\n\t\t\t\talbuminfo.cds = discs;\n\t\t\t\tvar output = tmpl.render({\n\t\t\t\t\talbum: albuminfo,\n\t\t\t\t\ttracklist: tracklisttemplate,\n\t\t\t\t\tparseduration: parseduration,\n\t\t\t\t\talbumhtml: albumtemplate\n\t\t\t\t});\n\t\t\t\t/*\n\t\t\t\t\tSend template to user\n\t\t\t\t*/\n\t\t\t\tresponse.end(output);\n\t\t\t});\n\t\t}\n\t\telse {\n\t\t\t/*\n\t\t\t\tAlbum not saved!\n\t\t\t\tAdd album to the database!\n\t\t\t*/\n\t\t\titunes.lookup(albumid, {entity: 'song'}, function(answer) {\n\t\t\t\tvar result \t\t= answer.results,\n\t\t\t\t\tinfo  \t\t= (result.splice(0,1))[0],\n\t\t\t\t\talbumtracks = [];\n\t\t\t\t_.each(result, function(track) {\n\t\t\t\t\tvar song = {\n\t\t\t\t\t\tname: track.trackName,\n\t\t\t\t\t\tduration: track.trackTimeMillis,\n\t\t\t\t\t\talbum: track.collectionName,\n\t\t\t\t\t\talbumid: track.collectionId,\n\t\t\t\t\t\tartistid: track.artistId,\n\t\t\t\t\t\tartist: track.artistName,\n\t\t\t\t\t\timage: track.artworkUrl100,\n\t\t\t\t\t\tid: track.trackId,\n\t\t\t\t\t\texplicit: track.trackExplicitness == \"explicit\" ? true : false,\n\t\t\t\t\t\tgenre: track.primaryGenreName,\n\t\t\t\t\t\tnumberinalbum: track.trackNumber,\n\t\t\t\t\t\tcdinalbum: track.discNumber,\n\t\t\t\t\t\ttracks: track.trackCount,\n\t\t\t\t\t\tcdcount: track.discCount,\n\t\t\t\t\t\tpreview: track.previewUrl,\n\t\t\t\t\t\trelease: track.releaseDate\n\t\t\t\t\t}\n\t\t\t\t\tdbquery.addTrack(song, function() {\n\t\t\t\t\t\tconsole.log(\"Track added successfully! (Scraped server side)\");\n\t\t\t\t\t});\n\t\t\t\t\talbumtracks.push(track.trackId);\n\t\t\t\t});\n\t\t\t\tvar album = {\n\t\t\t\t\tartist: info.artistName,\n\t\t\t\t\timage: info.artworkUrl100,\n\t\t\t\t\tartistid: info.artistId,\n\t\t\t\t\tid: info.collectionId,\n\t\t\t\t\ttracklist: albumtracks,\n\t\t\t\t\ttracks: albumtracks.length,\n\t\t\t\t\trelease: helpers.parseyear(info.releaseDate),\n\t\t\t\t\tname: info.collectionName,\n\t\t\t\t\texplicit: info.collectionExplicitness == \"explicit\" ? true : false\n\t\t\t\t}\n\t\t\t\tdbquery.addAlbum(album, function() {\n\t\t\t\t\tconsole.log(\"Album added successfully! (Scraped server side)\")\n\t\t\t\t});\n\t\t\t\t/*\n\t\t\t\t\tRepeat the whole thing now the album is added to the DB.\n\t\t\t\t*/\n\t\t\t\tconsole.log(\"Album added. Now repeating!\")\n\t\t\t\tviews.drawalbum(request, response);\n\t\t\t});\n\t\t\t//views.error({params: {code: 498}}, response);\n\t\t}\n\t})\n}\nthis.mainview = function(request, response) {\n\tresponse.sendfile(dirup + \"/frontend/index.html\");\n}\nthis.charts = function(request, response) {\n\tvar tmpl \t  = swig.compileFile(dirup + \"/sites/charts.html\"),\n\t\ttracklist = dirup + \"/sites/tracklist.html\",\n\t\ttable\t  = charts.table,\n\t\toutput\t  = tmpl.render({\n\t\t\talbum: \t\t\t {cds: [table]},\n\t\t\ttracklist: \t\t tracklist,\n\t\t\tparseduration:   parseduration,\n\t\t\tshowartistalbum: true,\n\t\t\tcoverstack: \t _.first(table, 10)\n\t\t});\n\t\tresponse.end(output);\n}\nthis.error = function(request, response) {\n\tvar tmpl \t = swig.compileFile(dirup + \"/sites/error.html\"),\n\t\terror \t = request.params.code,\n\t\tmessages = {\n\t\t\t404: \"We couldn't find that. If this problem persists, please contact the support!\", \n\t\t\t499: \"It seems like this artist doesn't exist. \",\n\t\t\t498: \"Whoops... this album doesn't seem to exist. \"\n\t\t},\n\t\tmessage  = messages[request.params.code],\n\t\tphrase\t = message != undefined ? message : \"Super fail: Not only that something didn't work, we also don't know what this error code means.\"\n\tvar\toutput \t = tmpl.render({error: phrase});\n\tresponse.end(output)\n}\nthis.about = function(request, response) {\n\tresponse.sendfile(dirup + \"/sites/about.html\");\n}"]],"start1":0,"start2":0,"length1":0,"length2":10548}]],"length":10548}
{"contributors":[],"silentsave":false,"ts":1359984211116,"patch":[[{"diffs":[[0,"rscore')"],[-1,""],[0,""],[1,","],[0,"\n\tdbquer"]],"start1":102,"start2":102,"length1":16,"length2":17},{"diffs":[[0,"pi_key: "],[-1,"\t"],[1,"   "],[0,"\"29c1ce9"]],"start1":368,"start2":368,"length1":17,"length2":19},{"diffs":[[0,"\tsecret:"],[1,"    "],[0," \"473680"]],"start1":416,"start2":416,"length1":16,"length2":20},{"diffs":[[0,"5ef\"\n\t})"],[1,";"],[0,"\n_.str ="]],"start1":459,"start2":459,"length1":16,"length2":17},{"diffs":[[0,"string')"],[1,";"],[0,"\n_.mixin"]],"start1":497,"start2":497,"length1":16,"length2":17},{"diffs":[[0,"utes*60)"],[-1,""],[0,""],[1,";"],[0,"\n\tif (se"]],"start1":893,"start2":893,"length1":16,"length2":17},{"diffs":[[0,"conds;\n}"],[-1,""],[0,""],[1,";"],[0,"\n/*\n\tThi"]],"start1":976,"start2":976,"length1":16,"length2":17},{"diffs":[[0,"tml'"],[-1,",\n\talbumwrapper \t  = dirup + '/sites/album-page.html'"],[1,";"],[0,"\nthi"]],"start1":1216,"start2":1216,"length1":61,"length2":9},{"diffs":[[0,"tarray.length =="],[1,"="],[0," 0 ? null : arti"]],"start1":1627,"start2":1627,"length1":32,"length2":33},{"diffs":[[0,"tinfo =="],[1,"="],[0," null &&"]],"start1":1725,"start2":1725,"length1":16,"length2":17},{"diffs":[[0,") {\n"],[-1,"\t\t\tvar loop = 0;\n"],[0,"\t\t\ti"]],"start1":1769,"start2":1769,"length1":25,"length2":8},{"diffs":[[0,"ength !="],[1,"="],[0," 0) {\n\t\t"]],"start1":1862,"start2":1862,"length1":16,"length2":17},{"diffs":[[0,"sults[0]"],[1,";"],[0,"\n\t\t\t\t\tva"]],"start1":1906,"start2":1906,"length1":16,"length2":17},{"diffs":[[0,"GenreName\n\t\t\t\t\t}"],[-1,""],[0,""],[1,";"],[0,"\n\t\t\t\t\tdbquery.ad"]],"start1":2031,"start2":2031,"length1":32,"length2":33},{"diffs":[[0,"tinfo !="],[1,"="],[0," null) {"]],"start1":2317,"start2":2317,"length1":16,"length2":17},{"diffs":[[0,"nfo.name"],[1,";"],[0,"\n\n\t\t\tif "]],"start1":2358,"start2":2358,"length1":16,"length2":17},{"diffs":[[0,"astfm =="],[1,"="],[0," undefin"]],"start1":2388,"start2":2388,"length1":16,"length2":17},{"diffs":[[0,"\timage: "],[-1,"\t\t"],[1,"     "],[0,"_.last(d"]],"start1":2550,"start2":2550,"length1":18,"length2":21},{"diffs":[[0,"\t\tmbid: "],[-1,"\t\t"],[1,"      "],[0,"data.mbi"]],"start1":2598,"start2":2598,"length1":18,"length2":22},{"diffs":[[0,"ta.mbid\n\t\t\t\t\t\t\t}"],[1,";"],[0,"\n\t\t\t\t\t\t\tartistin"]],"start1":2614,"start2":2614,"length1":32,"length2":33},{"diffs":[[0,"}\n\t\t\t\t)\n\t\t\t}"],[-1,""],[0,""],[1,";"],[0,"\n\t\t\t/*\n\t\t\t\tD"]],"start1":2722,"start2":2722,"length1":24,"length2":25},{"diffs":[[0,"marray.length =="],[1,"="],[0," 0 ? null : albu"]],"start1":2907,"start2":2907,"length1":32,"length2":33},{"diffs":[[0,": albumarray"],[1,";"],[0,"\n\t\t\t\t/*\n\t\t\t\t"]],"start1":2934,"start2":2934,"length1":24,"length2":25},{"diffs":[[0,"\t*/\n"],[-1,"\t\t\t\tvar before = albumsinfo\n"],[0,"\t\t\t\t"]],"start1":3030,"start2":3030,"length1":36,"length2":8},{"diffs":[[0,"ame : ''"],[1,","],[0," // Some"]],"start1":3165,"start2":3165,"length1":16,"length2":17},{"diffs":[[0," wtf...\n"],[-1,"\t\t\t\t\t\t"],[1,"                            "],[0,"name = p"]],"start1":3224,"start2":3224,"length1":22,"length2":44},{"diffs":[[0,"Of(\"(\"))"],[1,";"],[0,"\n\t\t\t\t\t\tr"]],"start1":3346,"start2":3346,"length1":16,"length2":17},{"diffs":[[0,"\t\t}\n"],[-1,"\t\t\t\tvar after = albumsinfo;\n"],[0,"\t\t\t\t"]],"start1":3401,"start2":3401,"length1":36,"length2":8},{"diffs":[[0,"\tif (items[0] =="],[1,"="],[0," undefined) {\n\t\t"]],"start1":3816,"start2":3816,"length1":32,"length2":33},{"diffs":[[0,"lbum.id)"],[1,";"],[0,"\n\t\t\t\t\t\t\t"]],"start1":3923,"start2":3923,"length1":16,"length2":17},{"diffs":[[0,"r discs = []"],[-1,""],[0,""],[1,";"],[0,"\n\t\t\t\t\t\t\t/*\tS"]],"start1":4205,"start2":4205,"length1":24,"length2":25},{"diffs":[[0,"cds, function(cd"],[-1,", key"],[0,""],[1,""],[0,") {\n\t\t\t\t\t\t\t\tvar "]],"start1":4277,"start2":4277,"length1":37,"length2":32},{"diffs":[[0,"s.push(disc)"],[1,";"],[0,"\n\t\t\t\t\t\t\t})\n\t"]],"start1":4388,"start2":4388,"length1":24,"length2":25},{"diffs":[[0,");\n\t\t\t\t\t\t\t})"],[1,";"],[0,"\n\t\t\t\t\t\t\talbu"]],"start1":4399,"start2":4399,"length1":24,"length2":25},{"diffs":[[0,"h(album)"],[1,";"],[0,"\n\t\t\t\t\t\t}"]],"start1":4456,"start2":4456,"length1":16,"length2":17},{"diffs":[[0,"\t\treturn"],[-1,""],[0,""],[1,";"],[0,"\n\t\t\t\t\t\t}"]],"start1":4521,"start2":4521,"length1":16,"length2":17},{"diffs":[[0,"lbumTracks()"],[1,";"],[0,"\n\t\t\t\t\t\t}\n\t\t\t"]],"start1":4563,"start2":4563,"length1":24,"length2":25},{"diffs":[[0,"\t\tvar j "],[-1,"\t\t"],[1,"       "],[0,"   = 0,\n"]],"start1":4595,"start2":4595,"length1":18,"length2":23},{"diffs":[[0,"umcount "],[1," "],[0,"= albums"]],"start1":4627,"start2":4627,"length1":16,"length2":17},{"diffs":[[0,"o.length"],[-1," "],[1,";"],[0,"\n\t\t\t\t\tge"]],"start1":4647,"start2":4647,"length1":17,"length2":17},{"diffs":[[0,"Tracks()"],[1,";"],[0,"\n\t\t\t\t}\n\t"]],"start1":4670,"start2":4670,"length1":16,"length2":17},{"diffs":[[0,"prename "],[-1,"\t\t"],[1,"         "],[0,"   = alb"]],"start1":4809,"start2":4809,"length1":18,"length2":25},{"diffs":[[0,"e   "],[-1,"\t\t"],[1,"       "],[0,"   "],[-1,"\t"],[0,"   ="]],"start1":4875,"start2":4875,"length1":14,"length2":18},{"diffs":[[0,"regex   "],[1," "],[0,"= /\\(([^"]],"start1":5000,"start2":5000,"length1":16,"length2":17},{"diffs":[[0,"nthesis "],[-1,"\t"],[1,"   "],[0,"   = pre"]],"start1":5040,"start2":5040,"length1":17,"length2":19},{"diffs":[[0,"kets    "],[1," "],[0,"= inpare"]],"start1":5106,"start2":5106,"length1":16,"length2":17},{"diffs":[[0,"th-2) : null"],[1,";"],[0,"\n\t\t\t\t\talbum."]],"start1":5181,"start2":5181,"length1":24,"length2":25},{"diffs":[[0,"um.name "],[-1,"\t\t\t"],[1,"          "],[0,"   = nam"]],"start1":5203,"start2":5203,"length1":19,"length2":26},{"diffs":[[0,"ubtitle "],[-1,"\t\t"],[1,"      "],[0,"   = wit"]],"start1":5244,"start2":5244,"length1":18,"length2":22},{"diffs":[[0,"bum);\n\t\t\t\t})"],[-1,""],[0,""],[1,";"],[0,"\n\t\t\t\talbumsi"]],"start1":5307,"start2":5307,"length1":24,"length2":25},{"diffs":[[0,"cksarray"],[-1,""],[0,""],[1,";"],[0,"\n\t\t\t\t\tif"]],"start1":5469,"start2":5469,"length1":16,"length2":17},{"diffs":[[0,"artist: "],[-1,"\t\t\t"],[1,"            "],[0,"artistin"]],"start1":5727,"start2":5727,"length1":19,"length2":28},{"diffs":[[0,"albums: "],[-1,"\t\t\t"],[1,"            "],[0,"albums,\n"]],"start1":5765,"start2":5765,"length1":19,"length2":28},{"diffs":[[0,"tracks: "],[-1,"\t\t\t"],[1,"            "],[0,"tracks,\n"]],"start1":5799,"start2":5799,"length1":19,"length2":28},{"diffs":[[0,"mplate: "],[-1,"\t\t"],[1,"     "],[0,"albumtem"]],"start1":5840,"start2":5840,"length1":18,"length2":21},{"diffs":[[0,"cklist: "],[-1,"\t\t\t"],[1,"         "],[0,"tracklis"]],"start1":5877,"start2":5877,"length1":19,"length2":25},{"diffs":[[0,"ration: "],[-1,"\t\t"],[1,"     "],[0,"parsedur"]],"start1":5926,"start2":5926,"length1":18,"length2":21},{"diffs":[[0,"server: "],[-1,"\t\t"],[1,"        "],[0,"true,\n\t\t"]],"start1":5964,"start2":5964,"length1":18,"length2":24},{"diffs":[[0," 10)\n\t\t\t\t\t})"],[-1,""],[0,""],[1,";"],[0,"\n\t\t\t\t\t/*\n\t\t\t"]],"start1":6027,"start2":6027,"length1":24,"length2":25},{"diffs":[[0,");\n\t\t\t})"],[-1,""],[0,""],[1,";"],[0,"\n\t\t}\n\t\te"]],"start1":6108,"start2":6108,"length1":16,"length2":17},{"diffs":[[0,";\n\t\t}\n\t\t\n\t})"],[1,";"],[0,"\n}"],[1,";"],[0,"\nthis.drawal"]],"start1":6205,"start2":6205,"length1":26,"length2":28},{"diffs":[[0,"ength =="],[1,"="],[0," 0 ? nul"]],"start1":6571,"start2":6571,"length1":16,"length2":17},{"diffs":[[0,"array[0]"],[1,";"],[0,"\n\t\t/*\n\t\t"]],"start1":6597,"start2":6597,"length1":16,"length2":17},{"diffs":[[0,"ms[0] =="],[-1,""],[0,""],[1,"="],[0," undefin"]],"start1":6904,"start2":6904,"length1":16,"length2":17},{"diffs":[[0,"scs = []"],[-1,""],[0,""],[1,";"],[0,"\n\t\t\t\t/*\t"]],"start1":7168,"start2":7168,"length1":16,"length2":17},{"diffs":[[0,"n(cd"],[-1,", key"],[0,""],[1,""],[0,") {\n"]],"start1":7242,"start2":7242,"length1":13,"length2":8},{"diffs":[[0,"sh(disc)"],[1,";"],[0,"\n\t\t\t\t})"],[1,";"],[0,"\n\t\t\t\talb"]],"start1":7339,"start2":7339,"length1":23,"length2":25},{"diffs":[[0," result "],[-1,"\t\t"],[1,"     "],[0,"= answer"]],"start1":7767,"start2":7767,"length1":18,"length2":21},{"diffs":[[0,"\t\tinfo  "],[-1,"\t\t"],[1,"      "],[0,"= (resul"]],"start1":7801,"start2":7801,"length1":18,"length2":22},{"diffs":[[0,"eDate\n\t\t\t\t\t}"],[-1,""],[0,""],[1,";"],[0,"\n\t\t\t\t\tdbquer"]],"start1":8487,"start2":8487,"length1":24,"length2":25},{"diffs":[[0," false\n\t\t\t\t}"],[-1,""],[0,""],[1,";"],[0,"\n\t\t\t\tdbquery"]],"start1":9015,"start2":9015,"length1":24,"length2":25},{"diffs":[[0," side)\")"],[-1,""],[0,""],[1,";"],[0,"\n\t\t\t\t});"]],"start1":9129,"start2":9129,"length1":16,"length2":17},{"diffs":[[0,"ating!\")"],[-1,""],[0,""],[1,";"],[0,"\n\t\t\t\tvie"]],"start1":9261,"start2":9261,"length1":16,"length2":17},{"diffs":[[0,"\n\t\t}\n\t})"],[1,";"],[0,"\n}"],[1,";"],[0,"\nthis.ma"]],"start1":9368,"start2":9368,"length1":18,"length2":20},{"diffs":[[0,"ex.html\");\n}"],[-1,""],[0,""],[1,";"],[0,"\nthis.charts"]],"start1":9468,"start2":9468,"length1":24,"length2":25},{"diffs":[[0,"ar tmpl "],[-1,"\t"],[1,"     "],[0,"  = swig"]],"start1":9528,"start2":9528,"length1":17,"length2":21},{"diffs":[[0,"acklist "],[1,"  "],[0,"= dirup "]],"start1":9597,"start2":9597,"length1":16,"length2":18},{"diffs":[[0,"\n\t\ttable"],[-1,"\t"],[1,"     "],[0,"  = char"]],"start1":9641,"start2":9641,"length1":17,"length2":21},{"diffs":[[0,"\t\toutput"],[-1,"\t"],[1,"    "],[0,"  = tmpl"]],"start1":9672,"start2":9672,"length1":17,"length2":20},{"diffs":[[0,"\talbum: "],[-1,"\t\t\t"],[1,"            "],[0," {cds: ["]],"start1":9704,"start2":9704,"length1":19,"length2":28},{"diffs":[[0,"cklist: "],[-1,"\t\t"],[1,"        "],[0," trackli"]],"start1":9747,"start2":9747,"length1":18,"length2":24},{"diffs":[[0,"uration:"],[1,"   "],[0,"   parse"]],"start1":9784,"start2":9784,"length1":16,"length2":19},{"diffs":[[0,"stalbum:"],[1,"   "],[0," true,\n\t"]],"start1":9824,"start2":9824,"length1":16,"length2":19},{"diffs":[[0,"rstack: "],[-1,"\t"],[1,"       "],[0," _.first"]],"start1":9849,"start2":9849,"length1":17,"length2":23},{"diffs":[[0,"tput);\n}"],[-1,""],[0,""],[1,";"],[0,"\nthis.er"]],"start1":9907,"start2":9907,"length1":16,"length2":17},{"diffs":[[0,"ar tmpl "],[-1,"\t"],[1,"      "],[0," = swig."]],"start1":9962,"start2":9962,"length1":17,"length2":22},{"diffs":[[0,"\t\terror "],[-1,"\t"],[1,"     "],[0," = reque"]],"start1":10026,"start2":10026,"length1":17,"length2":21},{"diffs":[[0,"essage  "],[1,"   "],[0,"= messag"]],"start1":10283,"start2":10283,"length1":16,"length2":19},{"diffs":[[0,"essages["],[-1,"request.params.code"],[1,"error"],[0,"],\n\t\tphr"]],"start1":10297,"start2":10297,"length1":35,"length2":21},{"diffs":[[0,"\t\tphrase"],[-1,"\t"],[1,"     "],[0," = messa"]],"start1":10313,"start2":10313,"length1":17,"length2":21},{"diffs":[[0,"ssage !="],[1,"="],[0," undefin"]],"start1":10331,"start2":10331,"length1":16,"length2":17},{"diffs":[[0,"ns.\""],[-1,"\n\tvar\t"],[1,",\n        "],[0,"output "],[-1,"\t"],[1,"    "],[0," = t"]],"start1":10456,"start2":10456,"length1":22,"length2":29},{"diffs":[[0,"(output)"],[1,";"],[0,"\n}"],[1,";"],[0,"\nthis.ab"]],"start1":10527,"start2":10527,"length1":18,"length2":20},{"diffs":[[0,"/about.html\");\n}"],[-1,""],[0,""],[1,";"]],"start1":10617,"start2":10617,"length1":16,"length2":17}]],"length":10634,"saved":false}
{"contributors":[],"silentsave":false,"ts":1359984451815,"patch":[[{"diffs":[[0,"5ef\"\n\t})"],[1,",\n    views   = this"],[0,";\n_.str "]],"start1":459,"start2":459,"length1":16,"length2":36}]],"length":10654,"saved":false}
{"contributors":[],"silentsave":false,"ts":1359984712045,"patch":[[{"diffs":[[0,"template    "],[1,"  "],[0,"= dirup + '/"]],"start1":1094,"start2":1094,"length1":24,"length2":26},{"diffs":[[0,"emplate     "],[1,"  "],[0,"= dirup + '/"]],"start1":1147,"start2":1147,"length1":24,"length2":26},{"diffs":[[0,"emplate "],[1,"  "],[0,"= dirup "]],"start1":1203,"start2":1203,"length1":16,"length2":18},{"diffs":[[0,"st.html'"],[1,",\n    tracktemplate       = dirup + '/sites/track.html'"],[0,";\nthis.d"]],"start1":1238,"start2":1238,"length1":16,"length2":71},{"diffs":[[0,"awalbum "],[1," "],[0,"= functi"]],"start1":6310,"start2":6310,"length1":16,"length2":17},{"diffs":[[0,"\t\t}\n\t});\n};\n"],[1,"this.drawtrack  = function(request, response) {\n    response.sendfile(tracktemplate);\n}\n"],[0,"this.mainvie"]],"start1":9451,"start2":9451,"length1":24,"length2":112},{"diffs":[[0,"ainview "],[1,"  "],[0,"= functi"]],"start1":9557,"start2":9557,"length1":16,"length2":18},{"diffs":[[0,".charts "],[1,"    "],[0,"= functi"]],"start1":9658,"start2":9658,"length1":16,"length2":20},{"diffs":[[0,"s.error "],[1,"     "],[0,"= functi"]],"start1":10096,"start2":10096,"length1":16,"length2":21},{"diffs":[[0,"output);\n};\n"],[-1,""],[0,"this.about ="]],"start1":10709,"start2":10709,"length1":24,"length2":24},{"diffs":[[0,"s.about "],[1,"     "],[0,"= functi"]],"start1":10724,"start2":10724,"length1":16,"length2":21}]],"length":10820,"saved":false}
{"contributors":[],"silentsave":false,"ts":1359985285414,"patch":[[{"diffs":[[0,"ile("],[-1,"dirup + \"/frontend/index.html\""],[1,"tracktemplate"],[0,");\n}"]],"start1":9614,"start2":9614,"length1":38,"length2":21}]],"length":10803,"saved":false}
{"ts":1359985466601,"patch":[[{"diffs":[[0,"st, response) {\n"],[1,"    var tmpl    = swig.compileFile(tracktemplate);\n    var output  = tmpl.render({\n        track: {\n            title: 'Drinking from the bottle.'\n        }  \n    });\n"],[0,"\tresponse.sendfi"]],"start1":9583,"start2":9583,"length1":32,"length2":199}]],"length":10970,"saved":false}
{"ts":1359985475427,"patch":[[{"diffs":[[0,"nse.send"],[-1,"file(tracktemplate"],[1,"(output"],[0,");\n};\nth"]],"start1":9772,"start2":9772,"length1":34,"length2":23}]],"length":10959,"saved":false}
{"ts":1359985718618,"patch":[[{"diffs":[[0,") {\n"],[-1,"    var tmpl    = swig.compileFile(tracktemplate);\n    var output  = tmpl.render({\n        track: {\n            title: 'Drinking from the bottle.'\n        }  \n    });\n\tresponse.send(output"],[1,"\tresponse.sendfile(dirup + \"/frontend/index.html\""],[0,");\n}"]],"start1":9595,"start2":9595,"length1":196,"length2":57}]],"length":10820,"saved":false}
{"ts":1359985916350,"patch":[[{"diffs":[[0,"    "],[-1,"response.sendfile(tracktemplate"],[1,"var tmpl    = swig.compileFile(tracktemplate);\n    var output  = tmpl.render({\n        track: {\n            title: 'hi'\n        }\n    });\n    response.end(output"],[0,");\n}"]],"start1":9511,"start2":9511,"length1":39,"length2":169}]],"length":10950,"saved":false}
{"ts":1359986001409,"patch":[[{"diffs":[[0,"        "],[-1,"titl"],[1,"nam"],[0,"e: 'hi'\n"]],"start1":9615,"start2":9615,"length1":20,"length2":19}]],"length":10949,"saved":false}
{"contributors":[],"silentsave":false,"ts":1359995009370,"patch":[[{"diffs":[[0,"g = "],[-1,"{\n\t\t\t\t\t\tname: track.trackName,\n\t\t\t\t\t\tduration: track.trackTimeMillis,\n\t\t\t\t\t\talbum: track.collectionName,\n\t\t\t\t\t\talbumid: track.collectionId,\n\t\t\t\t\t\tartistid: track.artistId,\n\t\t\t\t\t\tartist: track.artistName,\n\t\t\t\t\t\timage: track.artworkUrl100,\n\t\t\t\t\t\tid: track.trackId,\n\t\t\t\t\t\texplicit: track.trackExplicitness == \"explicit\" ? true : false,\n\t\t\t\t\t\tgenre: track.primaryGenreName,\n\t\t\t\t\t\tnumberinalbum: track.trackNumber,\n\t\t\t\t\t\tcdinalbum: track.discNumber,\n\t\t\t\t\t\ttracks: track.trackCount,\n\t\t\t\t\t\tcdcount: track.discCount,\n\t\t\t\t\t\tpreview: track.previewUrl,\n\t\t\t\t\t\trelease: track.releaseDate\n\t\t\t\t\t}"],[1,"itunes.remap(track)"],[0,";\n\t\t"]],"start1":7996,"start2":7996,"length1":589,"length2":27}]],"length":10387,"saved":false}
{"ts":1359995684103,"patch":[[{"diffs":[[0,"ate)"],[-1,";"],[1,","],[0,"\n    "],[-1,"var output  = tmpl.render("],[1,"    trackid = request.params.id,\n        song    = null;\n    dbquery.getSingleTrack(trackid, function (tracks) "],[0,"{\n  "]],"start1":8994,"start2":8994,"length1":40,"length2":125},{"diffs":[[0,"    "],[1,"if ("],[0,"track"],[-1,": {\n            name: 'hi'\n        }\n    });\n    response.end(output"],[1,"s.length === 0) {\n            itunes.lookup(trackid, {entity: 'song'}, function(response) {\n                if (response.length !== 0) {\n                    song = itunes.remap(response.results.splice(0,1));\n                    response.end(tmpl.render(song));\n                }\n            })\n        }\n        else {\n            response.end(tmpl.render(tracks[0]));\n        }\n    }"],[0,");\n}"]],"start1":9121,"start2":9121,"length1":81,"length2":401}]],"length":10792,"saved":false}
{"ts":1359995686491,"patch":[[{"diffs":[[0,"      })"],[1,";"],[0,"\n       "]],"start1":9419,"start2":9419,"length1":16,"length2":17}]],"length":10793,"saved":false}
{"ts":1359996029824,"patch":[[{"diffs":[[0,"              }\n"],[1,"                else {\n                    views.error({params: {code: 497}}, response);\n                }\n"],[0,"            });\n"]],"start1":9397,"start2":9397,"length1":32,"length2":139},{"diffs":[[0,"exist. \""],[1,",\n            497: \"Sorry... this track doesn't seem to exist.\""],[0,"\n\t\t},\n\t\t"]],"start1":10527,"start2":10527,"length1":16,"length2":79}]],"length":10963,"saved":false}
{"ts":1359996090786,"patch":[[{"diffs":[[0,"tion(res"],[-1,"ponse"],[0,") {\n    "]],"start1":9209,"start2":9209,"length1":21,"length2":16},{"diffs":[[0," if (res"],[-1,"ponse"],[0,".length "]],"start1":9236,"start2":9236,"length1":21,"length2":16},{"diffs":[[0,"emap(res"],[-1,"ponse"],[0,".results"]],"start1":9296,"start2":9296,"length1":21,"length2":16}]],"length":10948,"saved":false}
{"ts":1359996122868,"patch":[[{"diffs":[[0,"         else {\n"],[1,"                    console.log(\"No track here\");\n"],[0,"                "]],"start1":9405,"start2":9405,"length1":32,"length2":82}]],"length":10998,"saved":false}
{"ts":1359996347650,"patch":[[{"diffs":[[0,"var tmpl    "],[1,"        "],[0,"= swig.compi"]],"start1":8953,"start2":8953,"length1":24,"length2":32},{"diffs":[[0,"    "],[-1,"trackid = request.params.id,\n        song    = null;"],[1,"onlynumbers     = new RegExp('^[0-9]+$'),\n        trackid         = request.params.id,\n        song            = null;\n    if (!trackid.test(onlynumbers)) {\n        views.error({params: {code: 501}}, response);\n        return;\n    }"],[0,"\n   "]],"start1":9012,"start2":9012,"length1":60,"length2":240}]],"length":11186,"saved":false}
{"ts":1359996396193,"patch":[[{"diffs":[[0," exist.\""],[1,",\n            501: \"The Track ID can only contain numbers, so there is no music here :(\""],[0,"\n\t\t},\n\t\t"]],"start1":10813,"start2":10813,"length1":16,"length2":104}]],"length":11274,"saved":false}
{"ts":1359996429467,"patch":[[{"diffs":[[0,"f (!"],[-1,"trackid.test(onlynumbers"],[1,"onlynumbers.test(trackid"],[0,")) {"]],"start1":9140,"start2":9140,"length1":32,"length2":32}]],"length":11274,"saved":false}
{"ts":1359996457973,"patch":[[{"diffs":[[0,"if (res."],[1,"results."],[0,"length !"]],"start1":9425,"start2":9425,"length1":16,"length2":24}]],"length":11282,"saved":false}
{"ts":1359997106606,"patch":[[{"diffs":[[0,"var swig    "],[1,"    "],[0,"= require('s"]],"start1":47,"start2":47,"length1":24,"length2":28},{"diffs":[[0,"ig'),\n\t_"],[1,"    "],[0,"       ="]],"start1":76,"start2":76,"length1":16,"length2":20},{"diffs":[[0,"dbquery "],[1,"    "],[0,"= requir"]],"start1":121,"start2":121,"length1":16,"length2":20},{"diffs":[[0,"itunes  "],[1,"    "],[0,"= requir"]],"start1":162,"start2":162,"length1":16,"length2":20},{"diffs":[[0,"charts  "],[1,"    "],[0,"= requir"]],"start1":206,"start2":206,"length1":16,"length2":20},{"diffs":[[0,"Lastfm  "],[1,"    "],[0,"= requir"]],"start1":250,"start2":250,"length1":16,"length2":20},{"diffs":[[0,"helpers "],[1,"    "],[0,"= requir"]],"start1":287,"start2":287,"length1":16,"length2":20},{"diffs":[[0,"helpers "],[1,"    "],[0,"= helper"]],"start1":342,"start2":342,"length1":16,"length2":20},{"diffs":[[0,"elpers,\n"],[1,"    recognition = require('../frontend/scripts/recognition'),\n"],[0,"\tlastfm "]],"start1":365,"start2":365,"length1":16,"length2":78}]],"length":11376,"saved":false}
{"ts":1359997185888,"patch":[[{"diffs":[[0,"lice(0,1));\n"],[1,"                    /*\n                        Fetch YouTube video\n                    */\n"],[0,"            "]],"start1":9605,"start2":9605,"length1":24,"length2":114}]],"length":11466,"saved":false}
{"ts":1359997236934,"patch":[[{"diffs":[[0,"     */\n"],[1,"                    recognition.findVideo(song, function(video) {\n                        console.log(video);\n    "],[0,"        "]],"start1":9699,"start2":9699,"length1":16,"length2":130},{"diffs":[[0,"der(song));\n"],[1,"                    })\n"],[0,"            "]],"start1":9862,"start2":9862,"length1":24,"length2":47}]],"length":11603,"saved":false}
{"ts":1359997323129,"patch":[[{"diffs":[[0,"core'),\n"],[1,"    $           = require('jquery'),\n"],[0,"\tdbquery"]],"start1":112,"start2":112,"length1":16,"length2":53}]],"length":11640,"saved":false}
{"ts":1359997381302,"patch":[[{"diffs":[[0,"rs')"],[-1,",\n\thelpers     = helpers"],[0,".hel"]],"start1":372,"start2":372,"length1":32,"length2":8},{"diffs":[[0,"nition')"],[1,".recognition"],[0,",\n\tlastf"]],"start1":438,"start2":438,"length1":16,"length2":28}]],"length":11628,"saved":false}
{"ts":1359997738211,"patch":[[{"diffs":[[0,"       }"],[1,", $"],[0,")\n      "]],"start1":9912,"start2":9912,"length1":16,"length2":19}]],"length":11631,"saved":false}
{"ts":1359997813308,"patch":[[{"diffs":[[0,"    }, $"],[1,", _"],[0,")\n      "]],"start1":9915,"start2":9915,"length1":16,"length2":19}]],"length":11634,"saved":false}
{"ts":1359997877873,"patch":[[{"diffs":[[0,"der(song));\n"],[1,"                    /*\n                        Below you see jQuery and underscore are passed in. This is because the file\n                        is used on the client-side too and there is no require\n                    */\n"],[0,"            "]],"start1":9887,"start2":9887,"length1":24,"length2":249}]],"length":11859,"saved":false}
{"ts":1359997917239,"patch":[[{"diffs":[[0," }, $, _"],[1,", _.str"],[0,")\n      "]],"start1":10143,"start2":10143,"length1":16,"length2":23}]],"length":11866,"saved":false}
{"ts":1359998241216,"patch":[[{"diffs":[[0,"        "],[-1,"console.log"],[1,"song.ytid = helpers.parseYTId"],[0,"(video);"]],"start1":9814,"start2":9814,"length1":27,"length2":45}]],"length":11884,"saved":false}
{"ts":1359998245129,"patch":[[{"diffs":[[0,"video);\n"],[1,"                        console.log(song);\n"],[0,"        "]],"start1":9852,"start2":9852,"length1":16,"length2":59}]],"length":11927,"saved":false}
{"ts":1359998274917,"patch":[[{"diffs":[[0,"lice(0,1));\n"],[1,"                    console.log(song);\n"],[0,"            "]],"start1":9630,"start2":9630,"length1":24,"length2":63}]],"length":11966,"saved":false}
{"ts":1359998310326,"patch":[[{"diffs":[[0,"        "],[-1,"song = itunes.remap"],[1,"console.log"],[0,"(res.res"]],"start1":9588,"start2":9588,"length1":35,"length2":27},{"diffs":[[0,"        "],[-1,"console.log(song"],[1,"song = itunes.remap(res.results.splice(0,1)"],[0,");\n     "]],"start1":9646,"start2":9646,"length1":32,"length2":59}]],"length":11985,"saved":false}
{"ts":1359998358752,"patch":[[{"diffs":[[0,") {\n"],[-1,"                    console.log(res.results.splice(0,1));\n"],[0,"    "]],"start1":9572,"start2":9572,"length1":66,"length2":8}]],"length":11927,"saved":false}
{"ts":1359998385612,"patch":[[{"diffs":[[0,"ice(0,1)"],[1,"[0]"],[0,");\n     "]],"start1":9631,"start2":9631,"length1":16,"length2":19}]],"length":11930,"saved":false}
{"ts":1359998434474,"patch":[[{"diffs":[[0,"    "],[-1,"console.log"],[1,"response.end(tmpl.render"],[0,"(song)"],[1,")"],[0,";\n  "]],"start1":9883,"start2":9883,"length1":25,"length2":39},{"diffs":[[0,"    "],[-1,"response.end(tmpl.render"],[1,"dbquery.addTrack"],[0,"(song)"],[-1,")"],[0,";\n  "]],"start1":9940,"start2":9940,"length1":39,"length2":30}]],"length":11935,"saved":false}
{"ts":1359998458326,"patch":[[{"diffs":[[0,"ack(song"],[1,", function() {\n                            console.log(\"Track successfully added (Through /track/:id site)\");\n                        }"],[0,");\n     "]],"start1":9957,"start2":9957,"length1":16,"length2":151}]],"length":12070,"saved":false}
{"ts":1359998503404,"patch":[[{"diffs":[[0,", _.str)"],[1,";"],[0,"\n       "]],"start1":10355,"start2":10355,"length1":16,"length2":17},{"diffs":[[0,"   });\n}"],[1,";"],[0,"\nthis.ma"]],"start1":10642,"start2":10642,"length1":16,"length2":17}]],"length":12072,"saved":false}
{"contributors":[],"silentsave":false,"ts":1360077991077,"patch":[[{"diffs":[[0,"= this;\n"],[1,"/*\n    Underscore config\n*/\n"],[0,"_.str = "]],"start1":600,"start2":600,"length1":16,"length2":44},{"diffs":[[0,"h - 7);\n"],[1,"/*\n    Function for displaying duration correctly\n*/\n"],[0,"var\tpars"]],"start1":898,"start2":898,"length1":16,"length2":69},{"diffs":[[0,"\n/*\n"],[-1,"\tThis function returns the artistpage to the user\n*/\nthis.lastloop = null;"],[1,"    View paths\n*/"],[0,"\nvar"]],"start1":1205,"start2":1205,"length1":82,"length2":25},{"diffs":[[0,".html',\n"],[-1,"\t"],[1,"    "],[0,"albumtem"]],"start1":1275,"start2":1275,"length1":17,"length2":20},{"diffs":[[0,".html';\n"],[1,"//Proposed syntax!\nvar templates = {\n    registration: dirup + '/sites/registration.html'\n}\n/*\n    Routes\n*/\nthis.lastloop = null;\n"],[0,"this.dra"]],"start1":1441,"start2":1441,"length1":16,"length2":147},{"diffs":[[0,"wartist "],[1,"    "],[0,"= functi"]],"start1":1588,"start2":1588,"length1":16,"length2":20},{"diffs":[[0,"walbum  "],[-1,""],[0,""],[1,"    "],[0,"= functi"]],"start1":6592,"start2":6592,"length1":16,"length2":20},{"diffs":[[0,"wtrack  "],[-1,""],[0,""],[1,"    "],[0,"= functi"]],"start1":9194,"start2":9194,"length1":16,"length2":20},{"diffs":[[0,"ams.id,\n"],[1,"        /*\n\t\t\tPassing in the parseduration function with the song for simplicity\n        */\n"],[0,"        "]],"start1":9384,"start2":9384,"length1":16,"length2":108},{"diffs":[[0,"       song "],[1,"\t\t\t\t"],[0,"= itunes.rem"]],"start1":9851,"start2":9851,"length1":24,"length2":28},{"diffs":[[0,"1)[0]);\n"],[1,"                    song.parseduration \t= parseduration;\n"],[0,"        "]],"start1":9903,"start2":9903,"length1":16,"length2":73},{"diffs":[[0,"\n        else {\n"],[1,"        \tvar track = tracks[0]\n        \ttrack.parseduration = parseduration;\n"],[0,"            resp"]],"start1":10888,"start2":10888,"length1":32,"length2":109},{"diffs":[[0,"er(track"],[-1,"s[0]"],[0,"));\n    "]],"start1":11015,"start2":11015,"length1":20,"length2":16},{"diffs":[[0,"nview   "],[1,"    "],[0,"= functi"]],"start1":11056,"start2":11056,"length1":16,"length2":20},{"diffs":[[0,".charts     "],[-1,""],[0,""],[1,"    "],[0,"= function(r"]],"start1":11159,"start2":11159,"length1":24,"length2":28},{"diffs":[[0,".error      "],[-1,""],[0,""],[1,"    "],[0,"= function(r"]],"start1":11602,"start2":11602,"length1":24,"length2":28},{"diffs":[[0,".about      "],[1,"    "],[0,"= function(r"]],"start1":12385,"start2":12385,"length1":24,"length2":28},{"diffs":[[0,"about.html\");\n};"],[1,"\nthis.registration   = function(request, response) {\n    response.sendfile(templates.registration);\n}"]],"start1":12468,"start2":12468,"length1":16,"length2":117}]],"length":12585,"saved":false}
{"ts":1360078025287,"patch":[[{"diffs":[[0,"plate      ="],[1,"  "],[0," dirup + '/s"]],"start1":1240,"start2":1240,"length1":24,"length2":26},{"diffs":[[0,"template       ="],[1,"  "],[0," dirup + '/sites"]],"start1":1294,"start2":1294,"length1":32,"length2":34},{"diffs":[[0,"template   ="],[1,"  "],[0," dirup + '/s"]],"start1":1352,"start2":1352,"length1":24,"length2":26},{"diffs":[[0,"late       ="],[1,"  "],[0," dirup + '/s"]],"start1":1413,"start2":1413,"length1":24,"length2":26},{"diffs":[[0,"tes = {\n"],[-1,""],[0,"    regi"]],"start1":1486,"start2":1486,"length1":16,"length2":16},{"diffs":[[0,"tration:"],[1,"          "],[0," dirup +"]],"start1":1503,"start2":1503,"length1":16,"length2":26}]],"length":12603,"saved":false}
{"contributors":[],"silentsave":false,"ts":1360079996489,"patch":[[{"diffs":[[0,"on.html'"],[1,",\n    newuser:                dirup + '/sites/new-user.html'"],[0,"\n}"],[1,";"],[0,"\n/*\n    "]],"start1":1548,"start2":1548,"length1":18,"length2":79},{"diffs":[[0,"stration);\n}"],[1,";\nthis.newuser        = function(request, response) {\n    console.log(request.params);\n};"]],"start1":12652,"start2":12652,"length1":12,"length2":101}]],"length":12753,"saved":false}
{"ts":1360080008718,"patch":[[{"diffs":[[0,"arams);\n"],[1,"    response.end(\"You were successfully registered\");\n"],[0,"};"]],"start1":12743,"start2":12743,"length1":10,"length2":64}]],"length":12807,"saved":false}
{"contributors":[],"silentsave":false,"ts":1360080224942,"patch":[[{"diffs":[[0,"(request"],[-1,".params"],[0,");\n    r"]],"start1":12733,"start2":12733,"length1":23,"length2":16}]],"length":12800,"saved":false}
{"ts":1360080853780,"patch":[[{"diffs":[[0,"response) {\n"],[1,"    var signedrequest = require(\"facebook-signed-request\");\n    signedrequest.secret = \"f2bdb7700ef2d87a8c05b32ac31c013a\";\n"],[0,"    console."]],"start1":12706,"start2":12706,"length1":24,"length2":147},{"diffs":[[0,"(request"],[1,"['signed_request']"],[0,");\n    r"]],"start1":12856,"start2":12856,"length1":16,"length2":34}]],"length":12941,"saved":false}
{"ts":1360081245644,"patch":[[{"diffs":[[0,"uest"],[-1,"['signed_request']"],[0,");\n "]],"start1":12860,"start2":12860,"length1":26,"length2":8}]],"length":12923,"saved":false}
{"ts":1360081890658,"patch":[[{"diffs":[[0,";\n};"],[-1,"\nthis.newuser        = function(request, response) {\n    var signedrequest = require(\"facebook-signed-request\");\n    signedrequest.secret = \"f2bdb7700ef2d87a8c05b32ac31c013a\";\n    console.log(request);\n    response.end(\"You were successfully registered\");\n};"]],"start1":12661,"start2":12661,"length1":262,"length2":4}]],"length":12665,"saved":false}
